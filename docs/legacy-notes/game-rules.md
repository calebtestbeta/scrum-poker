---
title: Scrum Poker 遊戲規則與流程
original_path: game-rules.md
tags: ['legacy', 'game-rules', 'scrum-poker', 'documentation']
summary: 本文檔詳細說明 Scrum Poker 敏捷估點工具的完整遊戲規則與流程，包含玩家角色定義（Dev、QA、PO、Scrum Master等）、完整遊戲流程（房間建立、投票階段、開牌階段、結果分析）、投票規則、統計計算、權限管理、特殊情況處理以及智慧建議系統。文檔涵蓋三種運行模式（Firebase團隊模式、本地模式、試用模式）並提供完整的測試驗證點和版本更新記錄。
---

# 🎯 Scrum Poker 遊戲規則與流程

**版本**: v3.1.0  
**更新日期**: 2025-01-09  
**適用範圍**: 敏捷開發團隊 Story Point 估點會議

---

## 📋 目錄

1. [遊戲概述](#1-遊戲概述)
2. [玩家角色定義](#2-玩家角色定義)
3. [完整遊戲流程](#3-完整遊戲流程)
4. [投票規則](#4-投票規則)
5. [開牌與統計](#5-開牌與統計)
6. [權限與操作規則](#6-權限與操作規則)
7. [特殊情況處理](#7-特殊情況處理)
8. [智慧建議系統](#8-智慧建議系統)

---

## 1. 遊戲概述

### 1.1 目的
Scrum Poker 是一個敏捷開發估點工具，用於幫助開發團隊對使用者故事（User Story）或任務進行工作量評估。透過撲克牌投票方式，團隊成員可以匿名提供估點意見，避免錨定效應，提高估點準確度。

### 1.2 估點卡牌
系統提供以下估點選項：
- **費波納契數列**: 0.5, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89
- **特殊卡牌**: 
  - ☕ (咖啡) - 需要休息
  - ❓ (問號) - 需要更多資訊
  - ∞ (無限) - 任務太大，需要拆分

### 1.3 遊戲環境
- **Firebase 團隊模式**: 支援跨裝置即時同步，無人數限制
- **本地模式**: 單裝置多標籤頁同步，適合小團隊試用
- **試用模式**: 基本功能體驗，最多4人參與

---

## 2. 玩家角色定義

### 2.1 開發人員 (Dev)
- **職責**: 提供技術實作難度評估
- **權限**: 標準投票權限
- **特殊行為**: 無

### 2.2 測試人員 (QA)
- **職責**: 從測試角度評估工作量
- **權限**: 標準投票權限
- **特殊行為**: 可選擇任務類型（如：功能測試、自動化測試、效能測試）

### 2.3 產品負責人 (PO - Product Owner)
- **職責**: 從業務價值角度參與估點
- **權限**: 標準投票權限 + 任務類型選擇
- **特殊行為**: 可設定任務類型，影響智慧建議生成

### 2.4 Scrum Master
- **職責**: 引導估點會議進行
- **權限**: 標準投票權限 + 任務類型選擇 + 會議管理
- **特殊行為**: 可設定任務類型，通常負責會議節奏控制

### 2.5 其他角色 (Other)
- **職責**: 領域專家或其他利害關係人
- **權限**: 標準投票權限
- **特殊行為**: 無

### 2.6 任務類型設定權限
只有 **Scrum Master** 和 **PO** 角色可以在登入時選擇任務類型：
- 前端開發 (Frontend)
- 後端開發 (Backend)
- 全端開發 (Fullstack)
- 手機應用程式 (Mobile App)
- 資料分析 (Data Analysis)
- UI/UX 設計 (UI/UX Design)
- DevOps/部署 (DevOps)
- 測試開發 (Test Development)
- 架構設計 (Architecture)
- 一般任務 (General)

---

## 3. 完整遊戲流程

### 3.1 房間建立與加入階段

#### 3.1.1 建立房間
1. 玩家填寫個人資訊：
   - **玩家名稱**: 1-20 字符，支援中英文、數字、底線、連字符
   - **角色選擇**: Dev, QA, Scrum Master, PO, Other
   - **任務類型**: 僅 Scrum Master 和 PO 可選擇
   - **房間 ID**: 可自訂或系統自動生成

2. 房間 ID 規則：
   - **長度**: 1-64 字符
   - **允許字符**: 英數字、底線、連字符（不含空格及 Firebase 禁用字符 `. # $ / [ ]`）
   - **自動生成格式**: `ROOM_YYYYMMDD_HHMM` + 隨機碼

#### 3.1.2 安全驗證
系統會自動進行輸入清理，移除潛在惡意字符：
- HTML 字符: `< > " ' &`
- JavaScript 協議: `javascript:`
- Data 協議: `data:`
- VBScript 協議: `vbscript:`

### 3.2 等待其他玩家階段

#### 3.2.1 玩家列表顯示
- 顯示所有已加入玩家的名稱與角色
- 即時更新玩家狀態（線上/離線）
- 顯示總玩家數量

#### 3.2.2 房間分享
- 提供房間 ID 複製功能
- 支援 URL 分享（包含房間 ID 參數）
- 顯示房間連線狀態（Firebase/本地模式）

### 3.3 投票階段 (Voting Phase)

#### 3.3.1 投票開始條件
- 至少2名玩家在房間中
- 遊戲狀態為 "voting"（預設狀態）

#### 3.3.2 投票過程
1. **卡牌顯示**: 所有玩家看到相同的估點卡牌組
2. **選擇投票**: 點擊卡牌進行投票
3. **投票確認**: 
   - 投票後卡牌會高亮顯示已選擇狀態
   - 可重新選擇其他卡牌（會覆蓋原投票）
   - 投票立即同步到其他玩家裝置

#### 3.3.3 投票狀態顯示
- **玩家列表**: 顯示每位玩家的投票狀態
  - ✅ 已投票（顯示綠色勾號，不顯示具體數值）
  - ⏳ 未投票（顯示等待圖示）
- **進度指示**: 顯示 "X/Y 人已投票" 及完成百分比
- **頁面標題**: 動態更新為投票進度

#### 3.3.4 投票輸入方式
- **滑鼠點擊**: 點擊卡牌
- **鍵盤快捷鍵**: 數字鍵 0-9 對應費波納契數值
- **觸控手勢**: 支援行動裝置觸控
- **Enter 確認**: 聚焦卡牌後按 Enter 鍵確認

### 3.4 開牌階段 (Revealing Phase)

#### 3.4.1 開牌觸發條件
**任何玩家都可以觸發開牌**，無角色限制：
- 點擊「開牌」按鈕
- 使用空白鍵快捷鍵
- 向右滑動手勢（行動裝置）

#### 3.4.2 開牌效果
1. **卡牌翻轉動畫**: 所有玩家的投票卡牌同時翻轉顯示
2. **投票結果顯示**: 
   - 每位玩家上方顯示其投票數值
   - 未投票玩家顯示 "未投票" 標示
3. **統計資訊計算**: 自動計算並顯示統計數據

#### 3.4.3 統計資訊內容
- **總投票人數**: 有效投票數量
- **平均點數**: 數值投票的平均值（排除特殊卡牌）
- **最小值/最大值**: 數值投票的範圍
- **共識度**: 投票一致性百分比
- **投票分布**: 各數值的投票人數統計

#### 3.4.4 特殊卡牌處理
- **☕ (咖啡)**: 不計入數值統計，建議休息
- **❓ (問號)**: 不計入數值統計，標示為需要澄清
- **∞ (無限)**: 不計入數值統計，建議任務拆分

### 3.5 結果分析階段

#### 3.5.1 統計面板展示
- 右側面板自動展開顯示詳細統計
- 支援手動摺疊/展開統計面板
- 統計資料即時更新

#### 3.5.2 智慧建議生成
系統會根據投票結果自動生成智慧建議：
- **觸發條件**: 開牌完成且有有效投票
- **觸發者**: 點擊開牌的玩家負責生成建議
- **建議內容**: 基於投票分散度、角色分布、任務類型的分析
- **Firebase 同步**: 建議會同步到所有玩家裝置

### 3.6 重新開始階段

#### 3.6.1 清除投票觸發
**任何玩家都可以清除投票**，開始新一輪：
- 點擊「重新開始」按鈕
- 使用 Ctrl+R (Cmd+R) 快捷鍵
- 向左滑動手勢（行動裝置）

#### 3.6.2 清除效果
1. **卡牌重置**: 所有投票卡牌翻回背面
2. **投票狀態清除**: 玩家列表重置為未投票狀態
3. **統計清空**: 統計面板清空，等待新投票
4. **狀態重置**: 遊戲回到投票階段

---

## 4. 投票規則

### 4.1 投票有效性
- **單次投票**: 每位玩家每輪只能有一個有效投票
- **重複投票**: 允許更改投票，新投票會覆蓋舊投票
- **投票時機**: 任何時候都可以投票，包括已開牌後

### 4.2 投票同步規則
- **即時同步**: 投票後立即同步到所有連線裝置
- **離線投票**: 本地模式支援離線投票，重新連線後同步
- **投票保護**: 開牌狀態下的投票會保持顯示狀態

### 4.3 投票驗證
- **數值驗證**: 僅接受預定義的卡牌數值
- **輸入清理**: 防止惡意輸入或 XSS 攻擊
- **重複提交**: 防止重複提交相同投票

---

## 5. 開牌與統計

### 5.1 開牌權限
- **全員權限**: 任何角色的玩家都可以觸發開牌
- **即時同步**: 開牌狀態即時同步到所有裝置
- **狀態保護**: 開牌狀態會持續保持，直到清除投票

### 5.2 統計計算規則

#### 5.2.1 數值統計
- **納入計算**: 0.5, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89
- **排除項目**: ☕, ❓, ∞, 未投票

#### 5.2.2 平均值計算
```
平均點數 = 所有數值投票總和 ÷ 數值投票人數
結果四捨五入至小數點後一位
```

#### 5.2.3 共識度計算
```
共識度 = (最多人投票的數值人數 ÷ 總投票人數) × 100%
結果四捨五入至整數百分比
```

### 5.3 統計顯示格式
- **總投票數**: "N 人已投票"
- **平均點數**: "平均: X.X 點"
- **共識度**: "共識度: XX%"
- **範圍**: "範圍: X - X 點"

---

## 6. 權限與操作規則

### 6.1 全員操作權限
以下操作**任何角色的玩家都可以執行**：

#### 6.1.1 投票相關
- ✅ 提交投票
- ✅ 更改投票
- ✅ 觸發開牌
- ✅ 清除投票（重新開始）

#### 6.1.2 房間相關
- ✅ 離開房間
- ✅ 複製房間 ID
- ✅ 查看統計面板

#### 6.1.3 UI 操作
- ✅ 使用鍵盤快捷鍵
- ✅ 使用觸控手勢
- ✅ 摺疊/展開面板

### 6.2 角色特定權限

#### 6.2.1 Scrum Master 與 PO 專屬
- ✅ 選擇任務類型（影響智慧建議）
- ✅ 設定會議參數

#### 6.2.2 房間建立者
- ✅ 設定房間 ID
- ✅ 首次加入房間

### 6.3 系統自動權限
- 🤖 自動清理離線玩家（2分鐘無活動）
- 🤖 自動更新投票進度
- 🤖 自動生成智慧建議
- 🤖 自動同步房間狀態

---

## 7. 特殊情況處理

### 7.1 網路連線問題

#### 7.1.1 Firebase 模式
- **連線中斷**: 切換到離線模式，保持本地功能
- **重新連線**: 自動同步未同步的投票
- **同步失敗**: 顯示警告訊息，允許重試

#### 7.1.2 本地模式
- **跨標籤同步**: 使用 localStorage 進行同步
- **瀏覽器關閉**: 資料保存在本地儲存中

### 7.2 玩家管理

#### 7.2.1 玩家離開
- **主動離開**: 點擊離開按鈕，立即從玩家列表移除
- **被動離開**: 2分鐘無活動，自動標記為離線
- **重新加入**: 可使用相同名稱重新加入房間

#### 7.2.2 重複名稱
- **允許重複**: 系統允許相同名稱的玩家
- **ID 區分**: 使用唯一 ID 區分不同玩家實例

### 7.3 投票衝突處理

#### 7.3.1 同時投票
- **最後更新勝出**: 以最後收到的投票為準
- **時間戳記**: 使用時間戳記判斷先後順序

#### 7.3.2 開牌時投票
- **允許操作**: 開牌後仍可繼續投票
- **狀態保護**: 新投票會保持開牌顯示狀態

---

## 8. 智慧建議系統

### 8.1 建議觸發條件
- ✅ 已完成開牌
- ✅ 至少有2個有效數值投票
- ✅ 投票者包含不同角色
- ✅ 已設定任務類型（由 SM 或 PO）

### 8.2 建議生成邏輯

#### 8.2.1 分散度分析
- **高共識** (共識度 ≥ 80%): 建議接受估點
- **中度分散** (共識度 50-79%): 建議討論差異
- **高度分散** (共識度 < 50%): 建議重新討論需求

#### 8.2.2 角色分析
- **Dev vs QA 差異**: 技術複雜度 vs 測試工作量分析
- **PO 參與**: 業務價值與技術實作的平衡建議
- **Scrum Master**: 流程改善建議

#### 8.2.3 任務類型影響
不同任務類型會產生特定建議：
- **前端開發**: 關注 UI/UX 複雜度、瀏覽器兼容性
- **後端開發**: 關注資料庫設計、API 複雜度、效能考量
- **全端開發**: 整合前後端複雜度評估
- **測試開發**: 關注測試覆蓋率、自動化程度

### 8.3 建議同步機制

#### 8.3.1 生成責任
- **觸發者負責**: 點擊開牌的玩家執行建議生成
- **其他玩家**: 被動接收 Firebase 同步的建議

#### 8.3.2 Firebase 整合
- **自動保存**: 建議自動保存到 Firebase
- **即時同步**: 所有玩家即時收到建議更新
- **歷史記錄**: 支援查看歷史建議（未來功能）

---

## 9. 鍵盤快捷鍵與手勢

### 9.1 鍵盤快捷鍵
- **空白鍵**: 開牌
- **Ctrl+R / Cmd+R**: 重新開始（清除投票）
- **數字鍵 0-9**: 快速投票對應的費波納契數值
- **Enter**: 確認聚焦的卡牌選擇
- **H**: 展開/收合右側面板

### 9.2 觸控手勢
- **點擊**: 選擇卡牌投票
- **長按**: 顯示卡牌資訊
- **向左滑動**: 重新開始
- **向右滑動**: 開牌
- **向上滑動**: 展開統計面板
- **向下滑動**: 收合統計面板

---

## 10. 測試驗證點

### 10.1 功能測試驗證點
1. **房間建立**: 驗證房間 ID 格式、玩家資訊驗證
2. **玩家加入**: 驗證多人加入、重複名稱處理
3. **投票流程**: 驗證投票、重投、開牌、清除循環
4. **統計計算**: 驗證各種投票組合的統計正確性
5. **權限控制**: 驗證角色權限、操作限制
6. **智慧建議**: 驗證建議生成邏輯、同步機制

### 10.2 邊界測試驗證點
1. **輸入驗證**: 特殊字符、超長輸入、惡意輸入
2. **網路異常**: 斷線重連、同步衝突、延遲處理
3. **併發操作**: 同時投票、同時開牌、同時清除
4. **極限場景**: 大量玩家、快速操作、長時間會議

### 10.3 UI/UX 測試驗證點  
1. **響應式設計**: 不同螢幕尺寸、裝置旋轉
2. **無障礙功能**: 鍵盤導航、螢幕閱讀器支援
3. **效能表現**: 載入時間、動畫流暢度、記憶體使用
4. **跨瀏覽器**: Chrome、Firefox、Safari、Edge 兼容性

---

## 11. 版本更新記錄

### v3.1.0 (2025-01-09)
- ✅ 完善 Firebase 自動初始化流程
- ✅ 加強錯誤防呆機制
- ✅ 統一 RoomProvider 架構
- ✅ 改善 UI 狀態管理

### v3.0.0 (2025-01-01)
- ✅ 重構為 Vanilla JavaScript 架構
- ✅ 實作雙模式支援（Firebase/本地）
- ✅ 加入智慧建議系統
- ✅ 優化觸控手勢支援

---

**備註**: 本文件作為 Scrum Poker 系統的權威規則說明，所有開發、測試、文件撰寫都應以此為準。如有規則變更，請同步更新此文件。